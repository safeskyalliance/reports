<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Sheet Panel</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

<style>
body {
  font-family: 'Inter', sans-serif;
  background: #0f1c2e;
  color: white;
  display: flex;
  justify-content: center;
  padding: 20px;
}

.container {
  max-width: 800px;
  text-align: center;
}

.button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  padding: 18px;
  margin-bottom: 18px;
  border-radius: 14px;
  text-decoration: none;
  color: white;
  font-weight: 600;
  font-size: 17px;
  box-shadow: 0 6px 15px rgba(0,0,0,0.3);
  transition: 0.2s ease;
  width: 100%;
  box-sizing: border-box;
}

.button:active { transform: scale(0.98); }

.blue { background: linear-gradient(135deg, #2563eb, #1e40af); }
.orange { background: linear-gradient(135deg, #f97316, #c2410c); }
.green { background: linear-gradient(135deg, #22c55e, #15803d); }
.yellow { background: linear-gradient(135deg, #e0c060, #c9b04f); }

h1 { font-size: 26px; margin-bottom: 20px; }

/* Tabela */
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 30px;
  color: white;
}

table th, table td {
  border: 1px solid #555;
  padding: 8px;
  text-align: center;
}

table th {
  background-color: #1e2a45;
}

input, button {
  margin: 5px;
  padding: 5px;
  border-radius: 5px;
  border: none;
}

button#apply-filter {
  background-color: #2563eb;
  color: white;
  cursor: pointer;
  font-weight: 600;
}

</style>
</head>
<body>

<script>
// PROMPT ZA LOZINKU
const password = prompt("Unesite lozinku za admin panel:");
if(password !== "ssa") { 
    alert("Pogre≈°na lozinka! Vraƒáate se na poƒçetnu stranicu.");
    window.location.href = "index.html"; 
}
</script>

<div class="container">
  <h1>Admin Panel</h1>

  <a href="https://docs.google.com/spreadsheets/d/1MoFmt4GgCdACzU-PtgUvMMXfzfFxyVfMdEjhGsB6eAM/edit?usp=share_link" target="_blank" class="button blue">
    üìù Aerophoto REPORTS
  </a>

  <a href="https://docs.google.com/spreadsheets/d/10Ige2JEeDNje2XBx6nEFcOHA5Fp2KqgI9W8D3mZjRL8/edit?usp=share_link" target="_blank" class="button orange">
    üìù Equipement REPORTS
  </a>

  <a href="https://docs.google.com/spreadsheets/d/1gQWlOemMCl6rtWxQQnaEx9i2VCKoZKXZP524Zj88xag/edit?usp=share_link" target="_blank" class="button green">
    üìù Faults REPORTS
  </a>

  <a href="https://docs.google.com/spreadsheets/d/1MW8mvesMzpGToKCRk8dsSsgax_MXE68ifRWl1g3UZEY/edit?usp=share_link" target="_blank" class="button yellow">
    üìù Leave REPORTS
  </a>

  <a href="https://docs.google.com/spreadsheets/d/193ZdoReXuUn_gqzdeAzt7bSHaUXi2bI1ZTXMbK1afXY/edit?usp=share_link" target="_blank" class="button blue">
    üìù Refuelling REPORTS
  </a>

  <!-- Live Sheet Tabela -->
  <h2>Live Podaci sa Refuelling Sheet-a</h2>

  <label>Vehicle: <input type="text" id="vehicle-filter" placeholder="Unesi reg. broj"></label>
  <label>From: <input type="date" id="date-from"></label>
  <label>To: <input type="date" id="date-to"></label>
  <button id="apply-filter">Apply Filter</button>

  <table id="data-table">
    <thead>
      <tr>
        <th>Date</th>
        <th>Employee</th>
        <th>Vehicle</th>
        <th>Fuel Type</th>
        <th>Quantity (L)</th>
        <th>Cost (RSD)</th>
        <th>Odometer</th>
        <th>Notes</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<!-- PapaParse CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>

<script>
// URL do CSV Sheet-a
const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ63_O7Bwpf9uCQy1UzwjZkotEuJTEFK0rqKSfXUbN_b9ImPM2hGGN3CqfMDZkdjmpMrrgG-z2XfW70/pub?gid=958256399&single=true&output=csv";

let sheetData = [];

// Uƒçitavanje CSV podataka
Papa.parse(sheetURL, {
  download: true,
  header: true,
  complete: function(results) {
    sheetData = results.data;
    renderTable(sheetData); // Prika≈æi sve podatke
  }
});

// Funkcija za prikaz tabele
function renderTable(data) {
  const tbody = document.querySelector("#data-table tbody");
  tbody.innerHTML = "";
  data.forEach(row => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${row["Date of Refuelling"]}</td>
      <td>${row["Employee Full Name"]}</td>
      <td>${row["Vehicle Registration Number (License Plate)"]}</td>
      <td>${row["Type of Fuel Purchased"]}</td>
      <td>${row["Total Quantity (Liters)"]}</td>
      <td>${row["Total Cost of Refuelling (Currency: RSD)"]}</td>
      <td>${row["Odometer Reading (Kilometers)"]}</td>
      <td>${row["Additional Notes/Comments"]}</td>
    `;
    tbody.appendChild(tr);
  });
}

// Filter po vozilu i datumu
document.getElementById("apply-filter").addEventListener("click", () => {
  const vehicle = document.getElementById("vehicle-filter").value.trim().toLowerCase();
  const from = document.getElementById("date-from").value;
  const to = document.getElementById("date-to").value;

  const filtered = sheetData.filter(row => {
    const rowDate = row["Date of Refuelling"];
    const rowVehicle = row["Vehicle Registration Number (License Plate)"].toLowerCase();
    let dateOk = true, vehicleOk = true;

    if (from) dateOk = rowDate >= from;
    if (to) dateOk = dateOk && rowDate <= to;
    if (vehicle) vehicleOk = rowVehicle.includes(vehicle);

    return dateOk && vehicleOk;
  });

  renderTable(filtered);
});
</script>
</body>
</html>
